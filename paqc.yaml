# Run some public samples through PEPATAC

name: "ppqc"
sample_table: "paqc_annotation.csv"
subsample_table: "paqc_subannotation.csv"
sample_modifiers:
  imply:
    - if:
        organism: "human"
      then: 
        genome: "hg38"
        prealignments: "human_rDNA"
        max_len: -1
    - if:
        organism: "Homo sapiens"
      then: 
        genome: "hg38"
        prealignments: "human_rDNA"
        max_len: -1
    - if:
        read_type: "PAIRED"
      then:
        read1: "FQ1"
        read2: "FQ2"
    - if:
        read_type: "SINGLE"
      then:
        read1: "FQ"
  derive:
    attributes: ["read1", "read2"]
    sources:
      R: "$DATA/sra_fastq/{srr}.fastq.gz"
      S1: "$DATA/guertin/fastq/{srr}.fastq.gz"
      H1: "$DATA/guertin/fastq/{srr}_PE1.fastq.gz"
      H2: "$DATA/guertin/fastq/{srr}_PE2.fastq.gz"

amendments:
  sra_convert:
    metadata:
      pipeline_interfaces: ${CODE}/sra_convert/pipeline_interface_convert.yaml
    sample_modifiers:
      append:
        protocol: "*"
      derive:
        attributes: ["read1", "read2", "SRR_files"]
        sources:
         SRA: "${SRARAW}/{SRR}.sra"
         FQ: "${SRAFQ}/{SRR}.fastq.gz"
         FQ1: "${SRAFQ}/{SRR}_1.fastq.gz"
         FQ2: "${SRAFQ}/{SRR}_2.fastq.gz"
      append:
        SRR_files: SRA

      
metadata:
  output_dir: "/project/shefflab/processed/paqc"
  pipeline_interfaces: "$CODE/pepatac/pipeline_interface.yaml" 
  
